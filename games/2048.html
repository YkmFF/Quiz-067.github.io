<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>2048 - Number Puzzle</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 0;
      padding: 20px;
    }
    .container {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 16px;
      padding: 30px;
      text-align: center;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
      max-width: 350px;
    }
    h1 { color: #667eea; margin-top: 0; }
    .score { font-size: 1.3em; margin: 15px 0; font-weight: bold; }
    .game-board {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
      margin: 20px 0;
      background: #ccc;
      padding: 10px;
      border-radius: 8px;
    }
    .tile {
      aspect-ratio: 1;
      background: #ddd;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.8em;
      font-weight: bold;
      cursor: default;
      color: #333;
    }
    .tile.t2 { background: #eee4da; }
    .tile.t4 { background: #ede0c8; }
    .tile.t8 { background: #f2b179; color: white; }
    .tile.t16 { background: #f59563; color: white; }
    .tile.t32 { background: #f67c5f; color: white; }
    .tile.t64 { background: #f65e3b; color: white; }
    .tile.t128 { background: #edcf72; color: #776e65; font-size: 1.4em; }
    .tile.t256 { background: #edcc61; color: #776e65; font-size: 1.4em; }
    .tile.t512 { background: #edc850; color: #776e65; font-size: 1.4em; }
    .tile.t1024 { background: #edc53f; color: #776e65; font-size: 1.2em; }
    .tile.t2048 { background: #edc22e; color: #776e65; font-size: 1.2em; }
    .button-group { display: flex; gap: 10px; justify-content: center; }
    button {
      padding: 10px 20px;
      background: #667eea;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
    }
    button:hover { background: #764ba2; transform: translateY(-2px); }
    .back {
      background: rgba(102, 126, 234, 0.2);
      color: #667eea;
      border: 2px solid #667eea;
    }
    .info { font-size: 0.85em; color: #666; margin: 10px 0; }
  </style>
</head>
<body>
  <div class="container">
    <h1>2048</h1>
    <div class="score">Score: <span id="score">0</span></div>
    <div class="game-board" id="board"></div>
    <div class="info">Arrow Keys to move • Combine tiles to reach 2048!</div>
    <div class="button-group">
      <button onclick="location.reload()">New Game</button>
      <button class="back" onclick="window.location.href='../games.html'">← Back</button>
    </div>
  </div>
  
  <script>
    let grid = [];
    let score = 0;
    
    function initGame() {
      grid = Array(16).fill(0);
      score = 0;
      addNewTile();
      addNewTile();
      render();
    }
    
    function addNewTile() {
      const empty = grid.map((v, i) => v === 0 ? i : -1).filter(i => i >= 0);
      if (empty.length > 0) {
        const idx = empty[Math.floor(Math.random() * empty.length)];
        grid[idx] = Math.random() < 0.9 ? 2 : 4;
      }
    }
    
    function move(direction) {
      let moved = false;
      const newGrid = grid.map(x => x);
      
      for (let i = 0; i < 4; i++) {
        let row = [];
        for (let j = 0; j < 4; j++) {
          const idx = direction === 'left' ? i * 4 + j :
                      direction === 'right' ? i * 4 + (3 - j) :
                      direction === 'up' ? j * 4 + i :
                      j * 4 + i;
          if (newGrid[idx] !== 0) row.push(newGrid[idx]);
        }
        
        for (let j = 0; j < row.length - 1; j++) {
          if (row[j] === row[j + 1]) {
            row[j] *= 2;
            score += row[j];
            row.splice(j + 1, 1);
          }
        }
        
        while (row.length < 4) {
          if (direction === 'right' || direction === 'down') row.unshift(0);
          else row.push(0);
        }
        
        for (let j = 0; j < 4; j++) {
          const idx = direction === 'left' ? i * 4 + j :
                      direction === 'right' ? i * 4 + (3 - j) :
                      direction === 'up' ? j * 4 + i :
                      j * 4 + i;
          if (newGrid[idx] !== row[direction === 'right' || direction === 'down' ? 3 - j : j]) {
            moved = true;
          }
        }
      }
      
      if (moved) {
        grid = newGrid;
        addNewTile();
        render();
      }
    }
    
    function render() {
      const board = document.getElementById('board');
      board.innerHTML = '';
      grid.forEach(val => {
        const tile = document.createElement('div');
        tile.className = 'tile';
        if (val > 0) {
          tile.textContent = val;
          tile.classList.add(`t${val}`);
        }
        board.appendChild(tile);
      });
      document.getElementById('score').textContent = score;
    }
    
    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowLeft') move('left');
      if (e.key === 'ArrowRight') move('right');
      if (e.key === 'ArrowUp') move('up');
      if (e.key === 'ArrowDown') move('down');
    });
    
    initGame();
  </script>
</body>
</html>
